<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1100" height="420" viewBox="0 0 1100 420">
    <defs>
        <style>
            <![CDATA[
            .title {
                font: 700 20px Segoe UI, Arial, sans-serif;
                fill: #111;
            }

            .label {
                font: 600 14px Segoe UI, Arial, sans-serif;
                fill: #111;
            }

            .text {
                font: 12px Segoe UI, Arial, sans-serif;
                fill: #222;
            }

            .box {
                fill: #ffffff;
                stroke: #1f2937;
                stroke-width: 1.5;
                rx: 8;
            }

            .pill {
                fill: #eef2ff;
                stroke: #4338ca;
                stroke-width: 1.2;
                rx: 14;
            }

            .accent {
                fill: #ecfeff;
                stroke: #0891b2;
            }

            .scope {
                fill: #fff7ed;
                stroke: #c2410c;
            }

            .work {
                fill: #f0fdf4;
                stroke: #15803d;
            }

            .sentinel {
                fill: #f5f3ff;
                stroke: #6d28d9;
            }

            .arrow {
                stroke: #6b7280;
                stroke-width: 1.6;
                marker-end: url(#arrowhead);
                fill: none;
            }

            .dashed {
                stroke-dasharray: 6 4;
            }
            ]]>
        </style>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#6b7280" />
        </marker>
    </defs>

    <text x="20" y="32" class="title">Universal RBAC in Microsoft Defender XDR</text>
    <text x="20" y="54" class="text">PIM-enabled Entra groups → Unified RBAC roles → Scoped data → Defender
        workloads</text>

    <!-- Entra PIM groups -->
    <rect x="20" y="90" width="280" height="190" class="box accent" />
    <text x="34" y="112" class="label">Microsoft Entra ID (PIM)</text>
    <rect x="40" y="130" width="240" height="40" class="pill" />
    <text x="52" y="155" class="text">Microsoft XDR Reader - Permanent</text>
    <rect x="40" y="178" width="240" height="40" class="pill" />
    <text x="52" y="203" class="text">Microsoft XDR Analyst - Eligible</text>
    <rect x="40" y="226" width="240" height="40" class="pill" />
    <text x="52" y="251" class="text">Microsoft XDR Admin - Eligible</text>

    <!-- Unified RBAC roles -->
    <rect x="340" y="90" width="260" height="220" class="box" />
    <text x="354" y="112" class="label">Defender XDR – Unified RBAC roles</text>
    <rect x="360" y="130" width="220" height="44" class="pill" />
    <text x="372" y="156" class="text">Role: XDR Reader (read-only)</text>
    <rect x="360" y="182" width="220" height="44" class="pill" />
    <text x="372" y="208" class="text">Role: XDR Security Analyst</text>
    <rect x="360" y="234" width="220" height="44" class="pill" />
    <text x="372" y="260" class="text">Role: XDR Security Admin</text>

    <!-- Scopes / data sources -->
    <rect x="630" y="90" width="210" height="180" class="box scope" />
    <text x="644" y="112" class="label">Scopes and data sources</text>
    <text x="648" y="138" class="text">- Device groups</text>
    <text x="648" y="158" class="text">- Identities</text>
    <text x="648" y="178" class="text">- Email domains</text>
    <text x="648" y="198" class="text">- Raw data/content</text>
    <text x="648" y="218" class="text">- Other sources</text>

    <!-- Workloads -->
    <rect x="870" y="90" width="210" height="220" class="box work" />
    <text x="884" y="112" class="label">Defender workloads</text>
    <text x="888" y="138" class="text">- Defender for Endpoint</text>
    <text x="888" y="158" class="text">- Defender Vulnerability Mgmt</text>
    <text x="888" y="178" class="text">- Email and Collaboration</text>
    <text x="888" y="198" class="text"> (Defender for Office 365/EXO)</text>
    <text x="888" y="218" class="text">- Defender for Identity</text>
    <text x="888" y="238" class="text">- Defender for Cloud Apps</text>
    <text x="888" y="258" class="text">- Security Exposure Mgmt</text>

    <!-- Sentinel Data Lake -->
    <rect x="870" y="330" width="210" height="60" class="box sentinel" />
    <text x="884" y="352" class="label">Optional Integration</text>
    <text x="888" y="372" class="text">Microsoft Sentinel Data Lake</text>

    <!-- Arrows: Groups -> Roles -->
    <path d="M300,150 L340,150" class="arrow" />
    <path d="M300,198 L340,198" class="arrow" />
    <path d="M300,246 L340,246" class="arrow" />

    <!-- Arrows: Roles -> Scopes -->
    <path d="M600,152 L630,152" class="arrow" />
    <path d="M600,204 L630,204" class="arrow" />
    <path d="M600,256 L630,256" class="arrow" />

    <!-- Arrows: Scopes -> Workloads -->
    <path d="M840,150 L870,150" class="arrow" />
    <path d="M840,190 L870,190" class="arrow" />
    <path d="M840,230 L870,230" class="arrow" />

    <!-- Arrow: Scopes -> Sentinel -->
    <path d="M840, 360 L870, 360" class="arrow dashed" />

</svg>